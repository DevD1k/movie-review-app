{"ast":null,"code":"import _regeneratorRuntime from\"D:/Tutorials/WebDevPractice/Projects/usePopcorn/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Tutorials/WebDevPractice/Projects/usePopcorn/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Tutorials/WebDevPractice/Projects/usePopcorn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useRef}from\"react\";import StarRating from\"./StarRating\";import Loader from\"./Loader\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var KEY=\"1b626236\";export default function MovieDetails(_ref){var _watched$find;var selectedId=_ref.selectedId,onCloseMovie=_ref.onCloseMovie,onAddWatched=_ref.onAddWatched,watched=_ref.watched;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),movie=_useState2[0],setMovie=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),userRating=_useState6[0],setUserRating=_useState6[1];var countRef=useRef(0);useEffect(function(){if(userRating)countRef.current++;},[userRating]);var isWatched=watched.map(function(movie){return movie.imdbID;}).includes(selectedId);var watchedUserRating=(_watched$find=watched.find(function(movie){return movie.imdbID===selectedId;}))===null||_watched$find===void 0?void 0:_watched$find.userRating;var title=movie.Title,year=movie.Year,poster=movie.Poster,runtime=movie.Runtime,imdbRating=movie.imdbRating,plot=movie.Plot,released=movie.Released,actors=movie.Actors,director=movie.Director,genre=movie.Genre;function handleAdd(){var newWatchedMovie={imdbID:selectedId,title:title,year:year,poster:poster,imdbRating:Number(imdbRating),runtime:Number(runtime.split(\" \").at(0)),userRating:userRating,countRatingDecisions:countRef.current};onAddWatched(newWatchedMovie);onCloseMovie();}useEffect(function(){function callback(e){if(e.code===\"Escape\"){onCloseMovie();}}document.addEventListener(\"keydown\",callback);return function(){document.removeEventListener(\"keydown\",callback);};},[onCloseMovie]);useEffect(function(){function getMovieDetails(){return _getMovieDetails.apply(this,arguments);}function _getMovieDetails(){_getMovieDetails=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.next=3;return fetch(\"https://www.omdbapi.com/?apikey=\".concat(KEY,\"&i=\").concat(selectedId));case 3:res=_context.sent;_context.next=6;return res.json();case 6:data=_context.sent;setMovie(data);setIsLoading(false);case 9:case\"end\":return _context.stop();}},_callee);}));return _getMovieDetails.apply(this,arguments);}getMovieDetails();},[selectedId]);useEffect(function(){if(!title)return;document.title=\"Movie | \".concat(title);return function(){document.title=\"usePopcorn\";};},[title]);return/*#__PURE__*/_jsx(\"div\",{className:\"details\",children:isLoading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"header\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-back\",onClick:onCloseMovie,children:\"\\u2190\"}),/*#__PURE__*/_jsx(\"img\",{src:poster,alt:\"Poster of \".concat(movie,\" movie\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"details-overview\",children:[/*#__PURE__*/_jsx(\"h2\",{children:title}),/*#__PURE__*/_jsxs(\"p\",{children:[released,\" \\u2022 \",runtime]}),/*#__PURE__*/_jsx(\"p\",{children:genre}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2B50\\uFE0F\"}),imdbRating,\" IMDb rating\"]})]})]}),/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"rating\",children:!isWatched?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(StarRating,{maxRating:10,size:24,onSetRating:setUserRating}),userRating>0&&/*#__PURE__*/_jsx(\"button\",{className:\"btn-add\",onClick:handleAdd,children:\"+ Add to list\"})]}):/*#__PURE__*/_jsxs(\"p\",{children:[\"You rated with movie \",watchedUserRating,\" \",/*#__PURE__*/_jsx(\"span\",{children:\"\\u2B50\\uFE0F\"})]})}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"em\",{children:plot})}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Starring \",actors]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Directed by \",director]})]})]})});}","map":{"version":3,"names":["useState","useEffect","useRef","StarRating","Loader","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","KEY","MovieDetails","_ref","_watched$find","selectedId","onCloseMovie","onAddWatched","watched","_useState","_useState2","_slicedToArray","movie","setMovie","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","userRating","setUserRating","countRef","current","isWatched","map","imdbID","includes","watchedUserRating","find","title","Title","year","Year","poster","Poster","runtime","Runtime","imdbRating","plot","Plot","released","Released","actors","Actors","director","Director","genre","Genre","handleAdd","newWatchedMovie","Number","split","at","countRatingDecisions","callback","e","code","document","addEventListener","removeEventListener","getMovieDetails","_getMovieDetails","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","data","wrap","_callee$","_context","prev","next","fetch","concat","sent","json","stop","className","children","onClick","src","alt","maxRating","size","onSetRating"],"sources":["D:/Tutorials/WebDevPractice/Projects/usePopcorn/src/Components/MovieDetails.js"],"sourcesContent":["import { useState, useEffect, useRef } from \"react\";\r\nimport StarRating from \"./StarRating\";\r\nimport Loader from \"./Loader\";\r\n\r\nconst KEY = \"1b626236\";\r\n\r\nexport default function MovieDetails({\r\n  selectedId,\r\n  onCloseMovie,\r\n  onAddWatched,\r\n  watched,\r\n}) {\r\n  const [movie, setMovie] = useState({});\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [userRating, setUserRating] = useState(\"\");\r\n\r\n  const countRef = useRef(0);\r\n\r\n  useEffect(\r\n    function () {\r\n      if (userRating) countRef.current++;\r\n    },\r\n    [userRating]\r\n  );\r\n\r\n  const isWatched = watched.map((movie) => movie.imdbID).includes(selectedId);\r\n  const watchedUserRating = watched.find(\r\n    (movie) => movie.imdbID === selectedId\r\n  )?.userRating;\r\n\r\n  const {\r\n    Title: title,\r\n    Year: year,\r\n    Poster: poster,\r\n    Runtime: runtime,\r\n    imdbRating,\r\n    Plot: plot,\r\n    Released: released,\r\n    Actors: actors,\r\n    Director: director,\r\n    Genre: genre,\r\n  } = movie;\r\n\r\n  function handleAdd() {\r\n    const newWatchedMovie = {\r\n      imdbID: selectedId,\r\n      title,\r\n      year,\r\n      poster,\r\n      imdbRating: Number(imdbRating),\r\n      runtime: Number(runtime.split(\" \").at(0)),\r\n      userRating,\r\n      countRatingDecisions: countRef.current,\r\n    };\r\n\r\n    onAddWatched(newWatchedMovie);\r\n    onCloseMovie();\r\n  }\r\n\r\n  useEffect(\r\n    function () {\r\n      function callback(e) {\r\n        if (e.code === \"Escape\") {\r\n          onCloseMovie();\r\n        }\r\n      }\r\n\r\n      document.addEventListener(\"keydown\", callback);\r\n\r\n      return function () {\r\n        document.removeEventListener(\"keydown\", callback);\r\n      };\r\n    },\r\n    [onCloseMovie]\r\n  );\r\n\r\n  useEffect(\r\n    function () {\r\n      async function getMovieDetails() {\r\n        setIsLoading(true);\r\n        const res = await fetch(\r\n          `https://www.omdbapi.com/?apikey=${KEY}&i=${selectedId}`\r\n        );\r\n        const data = await res.json();\r\n        setMovie(data);\r\n        setIsLoading(false);\r\n      }\r\n      getMovieDetails();\r\n    },\r\n    [selectedId]\r\n  );\r\n\r\n  useEffect(\r\n    function () {\r\n      if (!title) return;\r\n      document.title = `Movie | ${title}`;\r\n\r\n      return function () {\r\n        document.title = \"usePopcorn\";\r\n      };\r\n    },\r\n    [title]\r\n  );\r\n\r\n  return (\r\n    <div className=\"details\">\r\n      {isLoading ? (\r\n        <Loader />\r\n      ) : (\r\n        <>\r\n          <header>\r\n            <button className=\"btn-back\" onClick={onCloseMovie}>\r\n              &larr;\r\n            </button>\r\n            <img src={poster} alt={`Poster of ${movie} movie`} />\r\n            <div className=\"details-overview\">\r\n              <h2>{title}</h2>\r\n              <p>\r\n                {released} &bull; {runtime}\r\n              </p>\r\n              <p>{genre}</p>\r\n              <p>\r\n                <span>⭐️</span>\r\n                {imdbRating} IMDb rating\r\n              </p>\r\n            </div>\r\n          </header>\r\n\r\n          {/* <p>{avgRating}</p> */}\r\n\r\n          <section>\r\n            <div className=\"rating\">\r\n              {!isWatched ? (\r\n                <>\r\n                  <StarRating\r\n                    maxRating={10}\r\n                    size={24}\r\n                    onSetRating={setUserRating}\r\n                  />\r\n                  {userRating > 0 && (\r\n                    <button className=\"btn-add\" onClick={handleAdd}>\r\n                      + Add to list\r\n                    </button>\r\n                  )}\r\n                </>\r\n              ) : (\r\n                <p>\r\n                  You rated with movie {watchedUserRating} <span>⭐️</span>\r\n                </p>\r\n              )}\r\n            </div>\r\n            <p>\r\n              <em>{plot}</em>\r\n            </p>\r\n            <p>Starring {actors}</p>\r\n            <p>Directed by {director}</p>\r\n          </section>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}