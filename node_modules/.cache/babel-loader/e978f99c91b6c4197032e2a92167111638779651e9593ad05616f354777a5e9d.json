{"ast":null,"code":"import _regeneratorRuntime from\"D:/Tutorials/WebDevPractice/Projects/usePopcorn/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Tutorials/WebDevPractice/Projects/usePopcorn/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"D:/Tutorials/WebDevPractice/Projects/usePopcorn/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"D:/Tutorials/WebDevPractice/Projects/usePopcorn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import Loader from\"./Components/Loader\";import NavBar from\"./Components/NavBar\";import Search from\"./Components/Search\";import NumResults from\"./Components/NumResults\";import Main from\"./Components/Main\";import Box from\"./Components/Box\";import MovieList from\"./Components/MovieList\";import ErrorMessage from\"./Components/ErrorMessage\";import MovieDetails from\"./Components/MovieDetails\";import WatchedSummary from\"./Components/WatchedSummary\";import WatchedMoviesList from\"./Components/WatchedMoviesList\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var KEY=\"1b626236\";export var average=function average(arr){return arr.reduce(function(acc,cur){return acc+cur/arr.length;},0);};export default function App(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),query=_useState2[0],setQuery=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),movies=_useState4[0],setMovies=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),selectedId=_useState10[0],setSelectedId=_useState10[1];// Lazily Initialize state to minimize expensive function calls\n// Function returns values only on initial render and doesn't execute again\nvar _useState11=useState(function(){var storedValue=localStorage.getItem(\"watched\");return storedValue?JSON.parse(storedValue):[];}),_useState12=_slicedToArray(_useState11,2),watched=_useState12[0],setWatched=_useState12[1];function handleSelectMovie(id){setSelectedId(function(selectedId){return id===selectedId?null:id;});}function handleCloseMovie(){setSelectedId(null);}function handleAddWatched(movie){setWatched(function(watched){return[].concat(_toConsumableArray(watched),[movie]);});}function handleDeleteWatched(id){setWatched(function(watched){return watched.filter(function(movie){return movie.imdbID!==id;});});}useEffect(function(){localStorage.setItem(\"watched\",JSON.stringify(watched));},[watched]);useEffect(function(){var controller=new AbortController();function fetchMovies(){return _fetchMovies.apply(this,arguments);}function _fetchMovies(){_fetchMovies=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setIsLoading(true);setError(\"\");_context.next=5;return fetch(\"https://www.omdbapi.com/?apikey=\".concat(KEY,\"&s=\").concat(query),{signal:controller.signal});case 5:res=_context.sent;if(res.ok){_context.next=8;break;}throw new Error(\"Something went wrong with fetching movies\");case 8:_context.next=10;return res.json();case 10:data=_context.sent;if(!(data.Response===\"False\")){_context.next=13;break;}throw new Error(\"Movie not found\");case 13:setMovies(data.Search);setError(\"\");_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](0);if(_context.t0.name!==\"AbortError\"){console.log(_context.t0.message);setError(_context.t0.message);}case 20:_context.prev=20;setIsLoading(false);return _context.finish(20);case 23:case\"end\":return _context.stop();}},_callee,null,[[0,17,20,23]]);}));return _fetchMovies.apply(this,arguments);}if(query.length<3){setMovies([]);setError(\"\");return;}handleCloseMovie();fetchMovies();return function(){controller.abort();};},[query]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(NavBar,{children:[/*#__PURE__*/_jsx(Search,{query:query,setQuery:setQuery}),/*#__PURE__*/_jsx(NumResults,{movies:movies})]}),/*#__PURE__*/_jsxs(Main,{children:[/*#__PURE__*/_jsxs(Box,{children:[isLoading&&/*#__PURE__*/_jsx(Loader,{}),!isLoading&&!error&&/*#__PURE__*/_jsx(MovieList,{movies:movies,onSelectMovie:handleSelectMovie}),error&&/*#__PURE__*/_jsx(ErrorMessage,{message:error})]}),/*#__PURE__*/_jsx(Box,{children:selectedId?/*#__PURE__*/_jsx(MovieDetails,{selectedId:selectedId,onCloseMovie:handleCloseMovie,onAddWatched:handleAddWatched,watched:watched}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(WatchedSummary,{watched:watched}),/*#__PURE__*/_jsx(WatchedMoviesList,{watched:watched,onDeleteWatched:handleDeleteWatched})]})})]})]});}","map":{"version":3,"names":["useEffect","useState","Loader","NavBar","Search","NumResults","Main","Box","MovieList","ErrorMessage","MovieDetails","WatchedSummary","WatchedMoviesList","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","KEY","average","arr","reduce","acc","cur","length","App","_useState","_useState2","_slicedToArray","query","setQuery","_useState3","_useState4","movies","setMovies","_useState5","_useState6","isLoading","setIsLoading","_useState7","_useState8","error","setError","_useState9","_useState10","selectedId","setSelectedId","_useState11","storedValue","localStorage","getItem","JSON","parse","_useState12","watched","setWatched","handleSelectMovie","id","handleCloseMovie","handleAddWatched","movie","concat","_toConsumableArray","handleDeleteWatched","filter","imdbID","setItem","stringify","controller","AbortController","fetchMovies","_fetchMovies","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","data","wrap","_callee$","_context","prev","next","fetch","signal","sent","ok","Error","json","Response","t0","name","console","log","message","finish","stop","abort","children","onSelectMovie","onCloseMovie","onAddWatched","onDeleteWatched"],"sources":["D:/Tutorials/WebDevPractice/Projects/usePopcorn/src/App.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport Loader from \"./Components/Loader\";\nimport NavBar from \"./Components/NavBar\";\nimport Search from \"./Components/Search\";\nimport NumResults from \"./Components/NumResults\";\nimport Main from \"./Components/Main\";\nimport Box from \"./Components/Box\";\nimport MovieList from \"./Components/MovieList\";\nimport ErrorMessage from \"./Components/ErrorMessage\";\nimport MovieDetails from \"./Components/MovieDetails\";\nimport WatchedSummary from \"./Components/WatchedSummary\";\nimport WatchedMoviesList from \"./Components/WatchedMoviesList\";\n\nconst KEY = \"1b626236\";\n\nexport const average = (arr) =>\n  arr.reduce((acc, cur) => acc + cur / arr.length, 0);\n\nexport default function App() {\n  const [query, setQuery] = useState(\"\");\n  const [movies, setMovies] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [selectedId, setSelectedId] = useState(null);\n  // Lazily Initialize state to minimize expensive function calls\n  // Function returns values only on initial render and doesn't execute again\n  const [watched, setWatched] = useState(function () {\n    const storedValue = localStorage.getItem(\"watched\");\n    return storedValue ? JSON.parse(storedValue) : [];\n  });\n\n  function handleSelectMovie(id) {\n    setSelectedId((selectedId) => (id === selectedId ? null : id));\n  }\n\n  function handleCloseMovie() {\n    setSelectedId(null);\n  }\n\n  function handleAddWatched(movie) {\n    setWatched((watched) => [...watched, movie]);\n  }\n\n  function handleDeleteWatched(id) {\n    setWatched((watched) => watched.filter((movie) => movie.imdbID !== id));\n  }\n\n  useEffect(\n    function () {\n      localStorage.setItem(\"watched\", JSON.stringify(watched));\n    },\n    [watched]\n  );\n\n  useEffect(\n    function () {\n      const controller = new AbortController();\n\n      async function fetchMovies() {\n        try {\n          setIsLoading(true);\n          setError(\"\");\n\n          const res = await fetch(\n            `https://www.omdbapi.com/?apikey=${KEY}&s=${query}`,\n            { signal: controller.signal }\n          );\n\n          if (!res.ok)\n            throw new Error(\"Something went wrong with fetching movies\");\n\n          const data = await res.json();\n          if (data.Response === \"False\") throw new Error(\"Movie not found\");\n\n          setMovies(data.Search);\n          setError(\"\");\n        } catch (err) {\n          if (err.name !== \"AbortError\") {\n            console.log(err.message);\n            setError(err.message);\n          }\n        } finally {\n          setIsLoading(false);\n        }\n      }\n\n      if (query.length < 3) {\n        setMovies([]);\n        setError(\"\");\n        return;\n      }\n\n      handleCloseMovie();\n      fetchMovies();\n\n      return function () {\n        controller.abort();\n      };\n    },\n    [query]\n  );\n\n  return (\n    <>\n      <NavBar>\n        <Search query={query} setQuery={setQuery} />\n        <NumResults movies={movies} />\n      </NavBar>\n\n      <Main>\n        <Box>\n          {isLoading && <Loader />}\n          {!isLoading && !error && (\n            <MovieList movies={movies} onSelectMovie={handleSelectMovie} />\n          )}\n          {error && <ErrorMessage message={error} />}\n        </Box>\n\n        <Box>\n          {selectedId ? (\n            <MovieDetails\n              selectedId={selectedId}\n              onCloseMovie={handleCloseMovie}\n              onAddWatched={handleAddWatched}\n              watched={watched}\n            />\n          ) : (\n            <>\n              <WatchedSummary watched={watched} />\n              <WatchedMoviesList\n                watched={watched}\n                onDeleteWatched={handleDeleteWatched}\n              />\n            </>\n          )}\n        </Box>\n      </Main>\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}